<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5RU 100 Training Plan - Evoke Method</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #1a4c96, #2d5aa0);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }
        
        .evoke-badge {
            background: #d32f2f;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .devon-badge {
            background: #008b00;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
            margin-left: 10px;
        }
        
        .header-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .header-info div {
            text-align: center;
            margin: 5px;
        }
        
        .race-schedule {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .race-schedule h3 {
            color: #008b00;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .race-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .race-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #008b00;
        }
        
        .race-item h4 {
            margin: 0 0 8px 0;
            color: #1a4c96;
        }
        
        .race-item p {
            margin: 4px 0;
            font-size: 13px;
        }
        
        .training-zones {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .zones-title {
            font-weight: bold;
            color: #d32f2f;
            margin-bottom: 10px;
        }
        
        .zone-item {
            display: inline-block;
            margin: 5px 10px;
            font-size: 12px;
        }
        
        .zone-1 { color: #2e7d32; font-weight: bold; }
        .zone-2 { color: #ed6c02; font-weight: bold; }
        .zone-3 { color: #d32f2f; font-weight: bold; }
        
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .phase-selector {
            display: inline-flex;
            background: white;
            border-radius: 25px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        .phase-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            margin: 0 2px;
            transition: all 0.3s ease;
            font-size: 12px;
        }
        
        .phase-btn.active {
            background: #1a4c96;
            color: white;
        }
        
        .phase-btn:hover {
            background: #e3f2fd;
        }
        
        .phase-btn.active:hover {
            background: #0d47a1;
        }
        
        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            vertical-align: top;
            font-size: 12px;
        }
        
        th {
            background: linear-gradient(135deg, #1a4c96, #2d5aa0);
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .week-col {
            background-color: #f8f9fa;
            font-weight: bold;
            width: 80px;
        }
        
        .date-col {
            background-color: #f1f3f4;
            width: 100px;
            font-size: 11px;
        }
        
        .hours-col {
            background-color: #e8f5e8;
            width: 60px;
            text-align: center;
            font-weight: bold;
        }
        
        .day-col {
            width: 120px;
        }
        
        .rest-day {
            background-color: #fff2f2;
            color: #666;
            text-align: center;
            font-style: italic;
        }
        
        .long-run {
            background-color: #e3f2fd;
            font-weight: bold;
        }
        
        .back-to-back {
            background-color: #f3e5f5;
        }
        
        .recovery-week {
            background-color: #fff3e0;
        }
        
        .peak-week {
            background-color: #ffebee;
            font-weight: bold;
        }
        
        .race-week {
            background-color: #e8f5e8;
            font-weight: bold;
            border: 2px solid #008b00;
        }
        
        .testing-week {
            background-color: #e1f5fe;
            font-weight: bold;
            border-left: 4px solid #01579b;
        }
        
        .me-session {
            background-color: #ffebee;
            border-left: 3px solid #d32f2f;
            font-weight: bold;
        }
        
        .threshold-session {
            background-color: #f1f8e9;
            border-left: 3px solid #4caf50;
        }
        
        .pure-z1 {
            color: #2e7d32;
        }
        
        .devon-race {
            background-color: #e8f5e8;
            border: 2px solid #008b00;
            font-weight: bold;
            color: #008b00;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        
        .legend-color {
            width: 20px;
            height: 15px;
            margin-right: 8px;
            border-radius: 3px;
            border: 1px solid #ccc;
        }
        
        .export-btn {
            background: #1a4c96;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 14px;
        }
        
        .export-btn:hover {
            background: #0d47a1;
        }
        
        .devon-export-btn {
            background: #008b00;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 14px;
        }
        
        .devon-export-btn:hover {
            background: #006400;
        }
        
        .progress-checkbox {
            width: 15px;
            height: 15px;
            margin-right: 5px;
        }
        
        @media (max-width: 768px) {
            .header-info {
                flex-direction: column;
            }
            
            .phase-selector {
                flex-wrap: wrap;
            }
            
            th, td {
                font-size: 10px;
                padding: 6px;
            }
            
            .race-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="evoke-badge">EVOKE ENDURANCE METHOD</div>
        <div class="devon-badge">SW RACES</div>
        <h1>Five Rivers Ultra 100 Mile Training Plan</h1>
        <div class="header-info">
            <div><strong>Start Date:</strong> 1st September 2025</div>
            <div><strong>Race Date:</strong> 10th May 2026</div>
            <div><strong>Duration:</strong> 37 weeks to race</div>
            <div><strong>Training Model:</strong> Scott Johnston ME Method</div>
            <div><strong>Peak Volume:</strong> 15 hours/week</div>
        </div>
    </div>
    
    <div class="race-schedule">
        <h3>Devon Race Schedule</h3>
        <div class="race-list">
            <div class="race-item">
                <h4>C RACE 1: East Devon 8 Trigs Ultra</h4>
                <p><strong>Week 11:</strong> 8th November 2025</p>
                <p><strong>Distance:</strong> 53K (8 Trigs Ultra)</p>
                <p><strong>Terrain:</strong> East Devon hills & coast with navigation</p>
                <p><strong>Purpose:</strong> Technical navigation & terrain preparation</p>
            </div>
            <div class="race-item">
                <h4>C RACE 2: East Devon FKT Challenge</h4>
                <p><strong>Week 22:</strong> 31st January/1st February 2026</p>
                <p><strong>Distance:</strong> 50K-50M FKT Attempt</p>
                <p><strong>Terrain:</strong> East Devon coastal paths & countryside</p>
                <p><strong>Purpose:</strong> Self-supported ultra FKT challenge</p>
            </div>
           <div class="race-item">
                <h4>B RACE: Southwest/Wales Ultra</h4>
                <p><strong>Week 27:</strong> 2nd-8th March 2026</p>
                <p><strong>Distance:</strong> 50M-100K Ultra</p>
                <p><strong>Terrain:</strong> Southwest/Wales (TBC when calendars published)</p>
                <p><strong>Purpose:</strong> Dress rehearsal (moved earlier for proper recovery)</p>
            </div>
            <div class="race-item">
                <h4>A RACE: Five Rivers Ultra 100</h4>
                <p><strong>Week 37:</strong> 10th May 2026</p>
                <p><strong>Distance:</strong> 100 miles</p>
                <p><strong>Terrain:</strong> Flat coastal trails (85% grass/dirt)</p>
                <p><strong>Purpose:</strong> GOAL RACE!</p>
            </div>
        </div>
    </div>
    
    <div class="training-zones">
        <div class="zones-title">EVOKE ENDURANCE TRAINING ZONES (Tom Evans Method)</div>
        <div class="zone-item zone-1">Zone 1 (Aerobic Base): <144 bpm - Nose breathing, conversational</div>
        <div class="zone-item zone-2">Zone 2 (Threshold): 145-167 bpm - Upper aerobic limit</div>
        <div class="zone-item zone-3">ME Sessions: Muscular Endurance - weighted uphill without lactate</div>
        <div class="zone-item">80/20 Rule: 80% easy aerobic base, 20% threshold + ME work</div>
        <div class="zone-item">Five Rivers Focus: Flat terrain endurance + fatigue resistance</div>
    </div>
    
    <div class="controls">
        <div class="phase-selector">
            <button class="phase-btn active" onclick="showPhase('all')">All Weeks</button>
            <button class="phase-btn" onclick="showPhase('phase1')">Base Building (1-8)</button>
            <button class="phase-btn" onclick="showPhase('phase2')">Threshold Dev (9-16)</button>
            <button class="phase-btn" onclick="showPhase('phase3')">Speed Reserve (17-24)</button>
            <button class="phase-btn" onclick="showPhase('phase4')">ME Development (25-32)</button>
            <button class="phase-btn" onclick="showPhase('phase5')">Race Specific (33-35)</button>
            <button class="phase-btn" onclick="showPhase('phase6')">Taper (36-37)</button>
        </div>
        <div>
            <button class="export-btn" onclick="exportToCSV()">Export to CSV</button>
            <button class="devon-export-btn" onclick="exportDevonRaces()">Export Devon Races</button>
            <button class="export-btn" onclick="toggleFKTAppendix()">FKT Guide</button>
            <button class="export-btn" onclick="window.print()">Print</button>
        </div>
    </div>
    
    <div class="table-container">
        <table id="trainingTable">
            <thead>
                <tr>
                    <th>Week</th>
                    <th>Dates</th>
                    <th>Hours</th>
                    <th>Workout 1</th>
                    <th>Workout 2</th>
                    <th>Workout 3</th>
                    <th>Workout 4</th>
                    <th>Workout 5</th>
                    <th>Workout 6</th>
                    <th>Workout 7</th>
                    <th>Notes/Focus</th>
                </tr>
            </thead>
            <tbody id="trainingBody">
                <!-- Training data will be populated by JavaScript -->
            </tbody>
        </table>
    </div>
    
    <div style="display: none;" id="fktAppendix">
        <div style="background: linear-gradient(135deg, #1a4c96, #2d5aa0); color: white; padding: 15px; margin: 20px 0 10px 0; border-radius: 8px; font-weight: bold; text-align: center;">
            FKT CHALLENGE APPENDIX
        </div>
        
        <div class="table-container">
            <h3 style="color: #1a4c96; margin-bottom: 20px;">East Devon FKT Challenge Options</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px;">
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #008b00;">
                    <h4 style="color: #008b00; margin-top: 0;">FKT Option 1: East Devon Way Point-to-Point</h4>
                    <p><strong>Route:</strong> Exmouth to Lyme Regis via East Devon Way</p>
                    <p><strong>Distance:</strong> ~40 miles (64km)</p>
                    <p><strong>Terrain:</strong> Coastal paths, countryside, varied elevation</p>
                    <p><strong>Navigation:</strong> Start: Exmouth seafront (SY 007 807)<br>
                    Finish: Lyme Regis harbour (SY 338 920)</p>
                    
                    <h5 style="color: #1a4c96;">Route Breakdown:</h5>
                    <ul style="font-size: 13px;">
                        <li><strong>Miles 0-8:</strong> Exmouth to Sidmouth via coastal path</li>
                        <li><strong>Miles 8-15:</strong> Sidmouth to Seaton via East Devon Way inland</li>
                        <li><strong>Miles 15-25:</strong> Seaton to Beer to Branscombe via coast</li>
                        <li><strong>Miles 25-32:</strong> Branscombe to Charmouth inland route</li>
                        <li><strong>Miles 32-40:</strong> Charmouth to Lyme Regis via coastal path</li>
                    </ul>
                    
                    <h5 style="color: #1a4c96;">Support Points:</h5>
                    <ul style="font-size: 13px;">
                        <li><strong>Mile 10:</strong> A3052 crossing near Sidmouth</li>
                        <li><strong>Mile 20:</strong> Seaton town center</li>
                        <li><strong>Mile 30:</strong> Charmouth village</li>
                        <li><strong>Mile 40:</strong> Lyme Regis finish</li>
                    </ul>
                    
                    <p><strong>Challenge Level:</strong> ⭐⭐⭐⭐ (High - long distance, varied terrain)</p>
                    <p><strong>Best For:</strong> January 50K+ FKT attempt</p>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #ff6b35;">
                    <h4 style="color: #ff6b35; margin-top: 0;">FKT Option 2: Jurassic Coast Section</h4>
                    <p><strong>Route:</strong> Exmouth to West Bay (Bridport)</p>
                    <p><strong>Distance:</strong> ~35 miles via South West Coast Path</p>
                    <p><strong>Terrain:</strong> Dramatic coastal cliffs, beaches, technical terrain</p>
                    <p><strong>Navigation:</strong> Follow SWCP waymarkers throughout</p>
                    
                    <h5 style="color: #1a4c96;">Route Highlights:</h5>
                    <ul style="font-size: 13px;">
                        <li>Budleigh Salterton pebble beach</li>
                        <li>Sidmouth red cliffs</li>
                        <li>Beer Head dramatic cliffs</li>
                        <li>Golden Cap (highest point on south coast - 191m)</li>
                        <li>Charmouth fossil beach</li>
                        <li>West Bay harbour finish</li>
                    </ul>
                    
                    <h5 style="color: #1a4c96;">Key Waypoints:</h5>
                    <ul style="font-size: 13px;">
                        <li><strong>Budleigh Salterton:</strong> SY 068 822</li>
                        <li><strong>Sidmouth:</strong> SY 128 874</li>
                        <li><strong>Beer:</strong> SY 229 893</li>
                        <li><strong>Golden Cap:</strong> SY 409 919</li>
                        <li><strong>West Bay:</strong> SY 465 906</li>
                    </ul>
                    
                    <p><strong>Challenge Level:</strong> ⭐⭐⭐⭐⭐ (Very High - coastal cliffs, elevation)</p>
                    <p><strong>Best For:</strong> April 100K FKT attempt</p>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #1a4c96;">
                    <h4 style="color: #1a4c96; margin-top: 0;">FKT Option 3: East Devon Circular (Sidmouth Base)</h4>
                    <p><strong>Route:</strong> Sidmouth-based circular route</p>
                    <p><strong>Distance:</strong> Design your own 50K loop</p>
                    <p><strong>Terrain:</strong> Mix of coast path, countryside, and hills</p>
                    <p><strong>Navigation:</strong> Start/Finish: Sidmouth town center</p>
                    
                    <h5 style="color: #1a4c96;">Loop Components (Choose Your Distance):</h5>
                    <ul style="font-size: 13px;">
                        <li><strong>Coastal section:</strong> Sidmouth to Beer and return (16 miles)</li>
                        <li><strong>Inland section:</strong> Sidmouth to Honiton hills loop (18 miles)</li>
                        <li><strong>Valley section:</strong> Sid Valley and Otter Valley paths (16 miles)</li>
                        <li><strong>Commons section:</strong> Woodbury Common loop (12 miles)</li>
                    </ul>
                    
                    <h5 style="color: #1a4c96;">Advantages:</h5>
                    <ul style="font-size: 13px;">
                        <li>Return to base multiple times for support</li>
                        <li>Flexible distance adjustment</li>
                        <li>Familiar local terrain</li>
                        <li>Easy crew access</li>
                    </ul>
                    
                    <p><strong>Challenge Level:</strong> ⭐⭐⭐ (Moderate - customizable difficulty)</p>
                    <p><strong>Best For:</strong> First-time FKT attempts or training runs</p>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #d32f2f;">
                    <h4 style="color: #d32f2f; margin-top: 0;">FKT Option 4: East Devon Peaks Challenge</h4>
                    <p><strong>Route:</strong> Multi-summit traverse</p>
                    <p><strong>Distance:</strong> 50K+ designed route</p>
                    <p><strong>Terrain:</strong> Hills, commons, and connecting valleys</p>
                    <p><strong>Navigation:</strong> Peak-to-peak navigation required</p>
                    
                    <h5 style="color: #1a4c96;">Peaks to Include:</h5>
                    <ul style="font-size: 13px;">
                        <li><strong>Woodbury Common:</strong> 175m (SY 025 875)</li>
                        <li><strong>East Hill, Ottery St Mary:</strong> 180m (SY 105 955)</li>
                        <li><strong>Aylesbeare Common:</strong> 155m (SY 065 895)</li>
                        <li><strong>Sidmouth hills:</strong> 185m (SY 135 885)</li>
                        <li><strong>High Peak:</strong> 157m (SY 155 858)</li>
                        <li><strong>West Down Beacon:</strong> 180m (SY 068 846)</li>
                    </ul>
                    
                    <h5 style="color: #1a4c96;">Route Strategy:</h5>
                    <ul style="font-size: 13px;">
                        <li>Start at lowest point for psychological advantage</li>
                        <li>Connect peaks via bridleways and footpaths</li>
                        <li>Use valleys for recovery between climbs</li>
                        <li>Finish on highest peak for achievement</li>
                    </ul>
                    
                    <p><strong>Challenge Level:</strong> ⭐⭐⭐⭐ (High - navigation + elevation)</p>
                    <p><strong>Best For:</strong> Hill training focus or unique challenge</p>
                </div>
            </div>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid #1a4c96;">
                    <h4 style="color: #1a4c96; margin-top: 0;">FKT Option 5: Devon Flat Terrain Simulator</h4>
                    <p><strong>Route:</strong> Exe Estuary Trail + Tarka Trail sections</p>
                    <p><strong>Distance:</strong> 50K+ flat loop</p>
                    <p><strong>Purpose:</strong> Five Rivers terrain simulation</p>
                    <p><strong>Benefits:</strong> Flat running practice, coastal wind exposure</p>
                </div>
            
            <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h3 style="color: #1a4c96; margin-bottom: 20px;">FKT Planning & Documentation Guide</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div>
                        <h4 style="color: #008b00;">Mapping Resources</h4>
                        <ul style="font-size: 13px;">
                            <li><strong>OS Maps:</strong> osmaps.ordnancesurvey.co.uk</li>
                            <li><strong>Strava Route Builder:</strong> strava.com/routes</li>
                            <li><strong>Komoot:</strong> komoot.com</li>
                            <li><strong>AllTrails:</strong> alltrails.com</li>
                            <li><strong>Outdoor Active:</strong> outdooractive.com</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #ff6b35;">FKT Documentation</h4>
                        <ul style="font-size: 13px;">
                            <li>GPS track (continuous recording)</li>
                            <li>Start/finish photos with timestamps</li>
                            <li>Route description (detailed written)</li>
                            <li>Witness statements (support crew)</li>
                            <li>Weather conditions record</li>
                            <li>Submit to fastestknowntime.com</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #1a4c96;">Essential Planning</h4>
                        <ul style="font-size: 13px;">
                            <li>Check footpath permissions</li>
                            <li>Identify bail-out points</li>
                            <li>Mark water sources & shops</li>
                            <li>Note road crossings for support</li>
                            <li>Consider seasonal factors</li>
                            <li>Weather contingency plans</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #d32f2f;">Race Day Strategy</h4>
                        <ul style="font-size: 13px;">
                            <li>Early start for daylight finish</li>
                            <li>Support crew with supplies</li>
                            <li>Backup navigation (phone + map)</li>
                            <li>Emergency contact plan</li>
                            <li>Flexible pacing strategy</li>
                            <li>Celebration plan at finish!</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div style="background: #e1f5fe; padding: 15px; border-radius: 8px; margin-top: 20px;">
                <h4 style="color: #01579b; margin-top: 0;">Potential Southwest/Wales B Race Options (2nd-8th March 2026)</h4>
                <p style="font-size: 14px; margin-bottom: 15px;"><em>Monitor these race series for 2026 calendar releases:</em></p>
                <ul style="font-size: 14px;">
                    <li><strong>Endurancelife Pembrokeshire CTS:</strong> Often early spring, coastal Wales, multiple distances including ultra</li>
                    <li><strong>Welsh 1000m Peaks Race:</strong> Typically spring dates, Snowdonia, 50+ mile challenge</li>
                    <li><strong>Brecon Beacons Ultra:</strong> Spring mountain ultra, various distances, dramatic terrain</li>
                    <li><strong>Exmoor Coast Ultra:</strong> Devon/Somerset border, coastal and moorland, 50-mile option</li>
                    <li><strong>Cotswold Way Challenge:</strong> Gloucestershire, 100K option, beautiful trail running</li>
                    <li><strong>Dorset Coast Path Ultra:</strong> Jurassic Coast challenge, 50+ miles, stunning scenery</li>
                    <li><strong>MudCrew Events:</strong> Various Southwest locations, ultra distances, professional organization</li>
                </ul>
                <p style="font-size: 13px; color: #666; margin-top: 15px;">
                    <strong>Action Plan:</strong> Monitor race calendars from January 2026 onwards. Book immediately when suitable race appears on 2nd-8th March. 
                    Have backup FKT challenge ready if no races available on exact dates.
                </p>
            </div>
            
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-top: 20px;">
                <h4 style="color: #008b00; margin-top: 0;">Pro Tips for FKT Success</h4>
                <ul style="font-size: 14px;">
                    <li><strong>Reconnaissance:</strong> Walk/jog key sections beforehand to identify potential issues</li>
                    <li><strong>Support Strategy:</strong> Position crew at accessible points, not every mile</li>
                    <li><strong>Nutrition Testing:</strong> Use FKT attempt to test 5 Rivers fueling strategy</li>
                    <li><strong>Weather Windows:</strong> Choose optimal conditions for best chance of success</li>
                    <li><strong>Local Knowledge:</strong> Use your Devon advantage - you know the terrain!</li>
                    <li><strong>Backup Plans:</strong> Have shorter routes ready if conditions deteriorate</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color rest-day"></div>
            <span>Rest Day</span>
        </div>
        <div class="legend-item">
            <div class="legend-color long-run"></div>
            <span>Long Run</span>
        </div>
        <div class="legend-item">
            <div class="legend-color back-to-back"></div>
            <span>Back-to-Back</span>
        </div>
        <div class="legend-item">
            <div class="legend-color me-session"></div>
            <span>ME Sessions</span>
        </div>
        <div class="legend-item">
            <div class="legend-color threshold-session"></div>
            <span>Threshold Work</span>
        </div>
        <div class="legend-item">
            <div class="legend-color devon-race"></div>
            <span>Devon Race Week</span>
        </div>
        <div class="legend-item">
            <div class="legend-color testing-week"></div>
            <span>Testing Week</span>
        </div>
        <div class="legend-item">
            <div class="legend-color recovery-week"></div>
            <span>Recovery Week</span>
        </div>
        <div class="legend-item">
            <div class="legend-color peak-week"></div>
            <span>Peak Week</span>
        </div>
    </div>

    <script>
        // Local storage functions for persistent checkboxes
        function saveCheckboxState(week, day, checked) {
            var key = 'training_checkbox_w' + week + '_d' + day;
            localStorage.setItem(key, checked);
        }
        
        function loadCheckboxState(week, day) {
            var key = 'training_checkbox_w' + week + '_d' + day;
            return localStorage.getItem(key) === 'true';
        }
        
        var trainingData = [
            // Phase 1: Base Building (Weeks 1-8)
            {week: 1, phase: 'phase1', dates: '1st-7th Sep', hours: '6.0', 
             sun: '1:00 Easy Z1 (TRAINING STARTS)', mon: 'REST', tue: '1:00 Easy Z1 + 4x30s strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '1:30 Easy Z1 (20min hiking)', sat: '1:30 Easy Z1', 
             notes: 'Base building begins. Establish aerobic foundation.', type: 'normal'},
            
            {week: 2, phase: 'phase1', dates: '8th-14th Sep', hours: '6.5', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: '1:00 Easy Z1 + 6x30s strides', 
             wed: '1:00 Easy Z1', thu: 'REST or 30min walk', fri: '1:45 Easy Z1 (25min hiking)', sat: '1:45 Easy Z1', 
             notes: 'Gentle volume increase. Focus on consistency.', type: 'normal'},
            
            {week: 3, phase: 'phase1', dates: '15th-21st Sep', hours: '7.0', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: '1:00 Easy Z1 + 6x30s strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:00 Easy Z1 (30min hiking)', sat: '2:00 Easy Z1', 
             notes: 'Building aerobic capacity systematically.', type: 'normal'},
            
            {week: 4, phase: 'phase1', dates: '22nd-28th Sep', hours: '7.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:15 Easy Z1 (35min hiking)', sat: '2:15 Easy Z1', 
             notes: 'Add strength training. Maintain aerobic focus.', type: 'normal'},
            
            {week: 5, phase: 'phase1', dates: '29th Sep-5th Oct', hours: '8.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:30 Easy Z1 (40min hiking)', sat: '2:30 Easy Z1', 
             notes: 'Steady progression. Monitor recovery.', type: 'normal'},
            
            {week: 6, phase: 'phase1', dates: '6th-12th Oct', hours: '8.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:45 Easy Z1 (45min hiking)', sat: '2:45 Easy Z1', 
             notes: 'Volume building steadily. Prepare for threshold.', type: 'normal'},
            
            {week: 7, phase: 'phase1', dates: '13th-19th Oct', hours: '9.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:00 Easy Z1 (50min hiking)', sat: '3:00 Easy Z1', 
             notes: 'Peak base phase volume. Solid foundation built.', type: 'normal'},
            
            {week: 8, phase: 'phase1', dates: '20th-26th Oct', hours: '7.0', 
             sun: '1:00 Easy Z1 + 4x30s strides', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:00 Easy Z1 (35min hiking)', sat: '2:00 Easy Z1', 
             notes: 'RECOVERY WEEK - Absorb base training adaptations.', type: 'recovery'},
            
            // Phase 2: Threshold Development (Weeks 9-16)
            {week: 9, phase: 'phase2', dates: '27th Oct-2nd Nov', hours: '8.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (6x6min @144bpm, 90s rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:00 Easy Z1 (55min hiking)', sat: '2:30 Easy Z1 (B2B)', 
             notes: 'Introduce threshold work. Tom Evans method begins.', type: 'normal'},
            
            {week: 10, phase: 'phase2', dates: '3rd-9th Nov', hours: '9.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (4x10min @144bpm, 2min rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:15 Easy Z1 (60min hiking)', sat: '2:45 Easy Z1 (B2B)', 
             notes: 'Build threshold capacity. Monitor HR drift.', type: 'normal'},
            
            {week: 11, phase: 'phase2', dates: '10th-16th Nov', hours: '8.0', 
             sun: '1:00 Easy Z1 recovery', mon: 'REST', tue: '45min Easy Z1 easy', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '45min Easy Z1 (pre-race)', sat: 'RACE: East Devon 8 Trigs Ultra (53K)', 
             notes: 'C RACE WEEK - East Devon 8 Trigs Ultra. Navigation practice.', type: 'devon-race'},
            
            {week: 12, phase: 'phase2', dates: '17th-23rd Nov', hours: '9.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (2x20min @144bpm, 3min rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:30 Easy Z1 (70min hiking)', sat: '3:00 Easy Z1 (B2B)', 
             notes: 'Post-race recovery. Resume threshold development.', type: 'normal'},
            
            {week: 13, phase: 'phase2', dates: '24th-30th Nov', hours: '10.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (4x8min @144bpm, 90s rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:45 Easy Z1 (75min hiking)', sat: '3:15 Easy Z1 (B2B)', 
             notes: 'Threshold development continues. Build speed reserve.', type: 'normal'},
            
            {week: 14, phase: 'phase2', dates: '1st-7th Dec', hours: '10.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (1x30min @144bpm)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '4:00 Easy Z1 (80min hiking)', sat: '3:30 Easy Z1 (B2B)', 
             notes: 'Longer threshold blocks. Endurance at speed.', type: 'normal'},
            
            {week: 15, phase: 'phase2', dates: '8th-14th Dec', hours: '11.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (3x10min @144bpm, 2min rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '4:15 Easy Z1 (85min hiking)', sat: '3:45 Easy Z1 (B2B)', 
             notes: 'Peak threshold development phase. Maintain focus.', type: 'normal'},
            
            {week: 16, phase: 'phase2', dates: '15th-21st Dec', hours: '8.5', 
             sun: '1:00 Easy Z1 + 4x30s strides', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:00 Easy Z1 (60min hiking)', sat: '2:30 Easy Z1', 
             notes: 'RECOVERY WEEK - Prepare for Christmas period.', type: 'recovery'},
            
            // Phase 3: Speed Reserve Development (Weeks 17-24)
            {week: 17, phase: 'phase3', dates: '22nd-28th Dec', hours: '7.0', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: '1:00 Easy Z1 + strides', 
             wed: 'REST (Christmas Day)', thu: '1:00 Easy Z1 (Boxing Day)', fri: 'REST', sat: '3:00 Easy Z1 (45min hiking)', 
             notes: 'Christmas Week - maintain fitness, enjoy festivities.', type: 'christmas'},
            
            {week: 18, phase: 'phase3', dates: '29th Dec-4th Jan', hours: '7.5', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: 'REST (New Years Day)', 
             wed: '1:00 Easy Z1 + strides', thu: '1:00 Easy Z1', fri: 'REST', sat: '3:30 Easy Z1 (50min hiking)', 
             notes: 'New Year Week - gradual return to training.', type: 'christmas'},
            
            {week: 19, phase: 'phase3', dates: '5th-11th Jan', hours: '8.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Tempo (5x1km, 2min rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:00 Easy Z1 (55min hiking)', sat: '2:30 Easy Z1', 
             notes: 'Speed work introduction. Build speed reserve.', type: 'normal'},
            
            {week: 20, phase: 'phase3', dates: '12th-18th Jan', hours: '9.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Track (8x800m, 90s rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:15 Easy Z1 (60min hiking)', sat: '2:45 Easy Z1 (B2B)', 
             notes: 'Track work for speed development. Tom Evans approach.', type: 'normal'},
            
            {week: 21, phase: 'phase3', dates: '19th-25th Jan', hours: '9.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Tempo (6x1km, 90s rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:30 Easy Z1 (65min hiking)', sat: '3:00 Easy Z1 (B2B)', 
             notes: 'Speed reserve building continues systematically.', type: 'normal'},
            
            {week: 22, phase: 'phase3', dates: '26th Jan-1st Feb', hours: '8.5', 
             sun: '1:00 Easy Z1 recovery', mon: 'REST', tue: '45min Easy Z1 easy', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '45min Easy Z1 (pre-FKT)', sat: 'FKT ATTEMPT: East Devon Route (50K+)', 
             notes: 'FKT CHALLENGE WEEK - East Devon 50K+ attempt.', type: 'devon-race'},
            
            {week: 23, phase: 'phase3', dates: '2nd-8th Feb', hours: '10.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Track (10x400m, 60s rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '3:45 Easy Z1 (70min hiking)', sat: '3:15 Easy Z1 (B2B)', 
             notes: 'Post-FKT recovery. Resume speed development.', type: 'normal'},
            
            {week: 24, phase: 'phase3', dates: '9th-15th Feb', hours: '10.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:00 Threshold (2x15min @144bpm, 3min rec)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '4:00 Easy Z1 (75min hiking)', sat: '3:30 Easy Z1 (B2B)', 
             notes: 'Speed reserve phase complete. Prepare for ME work.', type: 'normal'},
            
            // Phase 4: Muscular Endurance Development (Weeks 25-32)
            {week: 25, phase: 'phase4', dates: '16th-22nd Feb', hours: '11.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (12kg vest, treadmill 25% grade, 1000m vert)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '4:15 Easy Z1 (80min hiking)', sat: '3:45 Easy Z1 (B2B)', 
             notes: 'EVOKE ME TRAINING BEGINS - Revolutionary fatigue resistance method.', type: 'normal'},
            
            {week: 26, phase: 'phase4', dates: '23rd Feb-1st Mar', hours: '11.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (weighted uphill + threshold descent)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '4:30 Easy Z1 (85min hiking)', sat: '4:00 Easy Z1 (B2B)', 
             notes: 'ME development continues. Build muscular durability.', type: 'normal'},
            
            {week: 27, phase: 'phase4', dates: '2nd-8th Mar', hours: '9.0', 
             sun: '1:00 Easy Z1 recovery', mon: 'REST', tue: '45min Easy Z1 easy', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '45min Easy Z1 + race prep', sat: 'RACE: Southwest/Wales Ultra (50M-100K)', 
             notes: 'B RACE WEEK - Southwest/Wales Ultra dress rehearsal.', type: 'devon-race'},
            
            {week: 28, phase: 'phase4', dates: '9th-15th Mar', hours: '7.5', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: '45min Easy Z1 easy recovery', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '2:30 Easy Z1 (45min hiking)', sat: '2:00 Easy Z1', 
             notes: 'Post-B race recovery. Resume training gradually.', type: 'recovery'},
            
            {week: 29, phase: 'phase4', dates: '16th-22nd Mar', hours: '11.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (Tom Evans method: weighted uphill tempo)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '4:30 Easy Z1 (60min hiking)', sat: '4:00 Easy Z1 (B2B)', 
             notes: 'ME development resumes post-B race. Peak training ahead.', type: 'normal'},
            
            {week: 30, phase: 'phase4', dates: '23rd-29th Mar', hours: '12.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (double ME: AM weighted, PM threshold)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '4:45 Easy Z1 (75min hiking)', sat: '4:15 Easy Z1 (B2B)', 
             notes: 'Double ME sessions introduced. Peak ME development.', type: 'normal'},
            
            {week: 31, phase: 'phase4', dates: '30th Mar-5th Apr', hours: '12.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:45 ME SESSION (peak ME work: 15kg vest, 1200m vert)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '5:00 Easy Z1 (90min hiking)', sat: '4:30 Easy Z1 (B2B)', 
             notes: 'Peak ME training. Tom Evans UTMB-winning method.', type: 'normal'},
            
            {week: 32, phase: 'phase4', dates: '6th-12th Apr', hours: '13.0', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:45 ME SESSION (weekly for 7 weeks method)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '5:15 Easy Z1 (45min hiking)', sat: '4:45 Easy Z1 (B2B)', 
             notes: 'Peak ME phase continues. Muscular endurance maximized.', type: 'normal'},
            
            // Phase 5: Race Specific (Weeks 33-35)
            {week: 33, phase: 'phase5', dates: '13th-19th Apr', hours: '13.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (race-specific: flat terrain focus)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '5:30 Easy Z1 (race pace practice)', sat: '5:00 Easy Z1 (B2B race sim)', 
             notes: 'PEAK VOLUME WEEK. Race-specific adaptations.', type: 'peak'},
            
            {week: 34, phase: 'phase5', dates: '20th-26th Apr', hours: '12.5', 
             sun: '1:00 Easy Z1 + strength', mon: 'REST', tue: '1:30 ME SESSION (final ME peak)', 
             wed: '1:00 Easy Z1 RECOVERY', thu: 'REST', fri: '5:00 Easy Z1 (race nutrition practice)', sat: '4:30 Easy Z1 (B2B)', 
             notes: 'Race simulation focus. Fine-tune pacing and nutrition.', type: 'peak'},
            
            {week: 35, phase: 'phase5', dates: '27th Apr-3rd May', hours: '11.0', 
             sun: '1:00 Easy Z1', mon: 'REST', tue: '1:00 Threshold (3x10min @race pace)', 
             wed: '1:00 Easy Z1', thu: 'REST', fri: '4:00 Easy Z1 (race pace final hour)', sat: '3:30 Easy Z1 (B2B)', 
             notes: 'Final race-specific work. Taper preparation begins.', type: 'normal'},
            
            // Phase 6: Taper (Weeks 36-37)
            {week: 36, phase: 'phase6', dates: '4th-10th May', hours: '8.0', 
             sun: '1:00 Easy Z1 + 4x30s strides', mon: 'REST', tue: '45min Easy Z1 + 4x20s pickups', 
             wed: '45min Easy Z1', thu: 'REST', fri: '2:30 Easy Z1 (easy pace)', sat: '2:00 Easy Z1', 
             notes: 'TAPER WEEK. Maintain sharpness, reduce volume.', type: 'taper'},
            
            {week: 37, phase: 'phase6', dates: '11th-17th May', hours: '3.5', 
             sun: '45min Easy Z1 + 4x30s strides', mon: 'REST', tue: '30min Easy Z1 + 3x20s pickups', 
             wed: '30min Easy Z1', thu: 'REST', fri: '30min Easy Z1 shakeout OR REST', sat: 'RACE DAY - Five Rivers Ultra 100!', 
             notes: 'RACE WEEK - Five Rivers Ultra 100. Execute with confidence!', type: 'race'}
        ];
        
        var currentPhase = 'all';
        
        function showPhase(phase) {
            currentPhase = phase;
            
            var buttons = document.querySelectorAll('.phase-btn');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active');
            }
            event.target.classList.add('active');
            
            renderTable();
        }
        
        function renderTable() {
            var tbody = document.getElementById('trainingBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            var filteredData = currentPhase === 'all' ? trainingData : 
                                 trainingData.filter(function(week) { return week.phase === currentPhase; });
            
            for (var i = 0; i < filteredData.length; i++) {
                var week = filteredData[i];
                var row = document.createElement('tr');
                
                if (week.type === 'recovery') {
                    row.classList.add('recovery-week');
                } else if (week.type === 'peak') {
                    row.classList.add('peak-week');
                } else if (week.type === 'race') {
                    row.classList.add('race-week');
                } else if (week.type === 'testing') {
                    row.classList.add('testing-week');
                } else if (week.type === 'devon-race') {
                    row.classList.add('devon-race');
                } else if (week.type === 'taper') {
                    row.classList.add('peak-week');
                }
                
                function getCellClasses(workout) {
                    var classes = ['day-col'];
                    if (!workout) return classes.join(' ');
                    
                    if (workout === 'REST' || workout.indexOf('REST (') !== -1) {
                        classes.push('rest-day');
                    } else if (workout.indexOf('Long') !== -1 || workout.indexOf('Easy Z1 (B2B)') !== -1) {
                        classes.push('long-run');
                    } else if (workout.indexOf('B2B') !== -1) {
                        classes.push('back-to-back');
                    } else if (workout.indexOf('ME SESSION') !== -1) {
                        classes.push('me-session');
                    } else if (workout.indexOf('Threshold') !== -1 || workout.indexOf('Track') !== -1 || workout.indexOf('Tempo') !== -1) {
                        classes.push('threshold-session');
                    } else if (workout.indexOf('Easy Z1') !== -1) {
                        classes.push('pure-z1');
                    } else if (workout.indexOf('RACE') !== -1 || workout.indexOf('FKT') !== -1) {
                        classes.push('devon-race');
                    }
                    return classes.join(' ');
                }
                
                var days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
                var dayHtml = '';
                
                for (var j = 0; j < days.length; j++) {
                    var day = days[j];
                    var workout = week[day] || 'N/A';
                    var checkboxId = 'cb_w' + week.week + '_d' + j;
                    var isChecked = loadCheckboxState(week.week, j);
                    
                    dayHtml += '<td class="' + getCellClasses(workout) + '">' +
                              '<input type="checkbox" class="progress-checkbox" id="' + checkboxId + '" ' +
                              'onchange="saveCheckboxState(' + week.week + ',' + j + ', this.checked)" ' +
                              (isChecked ? 'checked' : '') + '>' + workout + '</td>';
                }
                
                row.innerHTML = 
                    '<td class="week-col">Week ' + week.week + '</td>' +
                    '<td class="date-col">' + week.dates + '</td>' +
                    '<td class="hours-col">' + week.hours + '</td>' +
                    dayHtml +
                    '<td>' + (week.notes || '') + '</td>';
                
                tbody.appendChild(row);
            }
        }
        
        function exportToCSV() {
            var headers = ['Week', 'Dates', 'Hours', 'Workout 1', 'Workout 2', 'Workout 3', 'Workout 4', 'Workout 5', 'Workout 6', 'Workout 7', 'Notes/Focus'];
            
            var csvContent = headers.join(',') + '\n';
            
            var filteredData = currentPhase === 'all' ? trainingData : 
                                 trainingData.filter(function(week) { return week.phase === currentPhase; });
            
            for (var i = 0; i < filteredData.length; i++) {
                var week = filteredData[i];
                var row = [
                    'Week ' + week.week,
                    '"' + week.dates + '"',
                    week.hours,
                    '"' + (week.sun || '') + '"',
                    '"' + (week.mon || '') + '"',
                    '"' + (week.tue || '') + '"',
                    '"' + (week.wed || '') + '"',
                    '"' + (week.thu || '') + '"',
                    '"' + (week.fri || '') + '"',
                    '"' + (week.sat || '') + '"',
                    '"' + (week.notes || '') + '"'
                ];
                csvContent += row.join(',') + '\n';
            }
            
            var blob = new Blob([csvContent], { type: 'text/csv' });
            var url = window.URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'FiveRivers_Evoke_Training_Plan_' + currentPhase + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        function toggleFKTAppendix() {
            var appendix = document.getElementById('fktAppendix');
            var table = document.querySelector('.table-container');
            var button = event.target;
            
            if (appendix && table) {
                if (appendix.style.display === 'none') {
                    appendix.style.display = 'block';
                    table.style.display = 'none';
                    button.textContent = 'Training Plan';
                    button.style.background = '#008b00';
                } else {
                    appendix.style.display = 'none';
                    table.style.display = 'block';
                    button.textContent = 'FKT Guide';
                    button.style.background = '#1a4c96';
                }
            }
        }
        
        function exportDevonRaces() {
            var raceData = [
                ['Race', 'Date', 'Distance', 'Location', 'Purpose'],
                ['East Devon 8 Trigs Ultra', '8th November 2025', '53K', 'East Devon', 'Navigation & terrain prep'],
                ['East Devon FKT Challenge', '31st Jan/1st Feb 2026', '50K+', 'East Devon', 'Self-supported ultra'],
                ['Southwest/Wales Ultra', '2nd-8th March 2026', '50M-100K', 'Southwest/Wales', 'Dress rehearsal'],
                ['Five Rivers Ultra 100', '10th May 2026', '100 miles', 'Essex/Suffolk Coast', 'GOAL RACE']
            ];
            
            var csvContent = raceData.map(function(row) { return row.join(','); }).join('\n');
            
            var blob = new Blob([csvContent], { type: 'text/csv' });
            var url = window.URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'Devon_Race_Schedule_2025-2026.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        // Initialize table on page load - multiple methods to ensure it works
        function initializeApp() {
            renderTable();
        }
        
        // Try multiple initialization approaches
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
        
        window.addEventListener('load', initializeApp);
        
        // Fallback initialization after a delay
        setTimeout(function() {
            if (document.getElementById('trainingBody') && document.getElementById('trainingBody').innerHTML === '') {
                renderTable();
            }
        }, 500);
    </script>
</body>
</html>
